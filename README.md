# KittiClass

KittiClass performance road type classification using Kitti Data. The model is able to distinguish between highway and smaller roads. The data was generated by combining GPS information with Open Street Map information.

The model is designed to perform well on street scenes, were many small features are relevant to determine class affiliation. Check out our Paper for a detailed model description [MultiNet](https://arxiv.org/abs/1612.07695).


Unfortunately the Data used for KittiClass is not publicly available. Thus it is not possible to train KittiClass yourself. However you can still use `demo.py` to utilize a pretrained model or use `train.py` to train on your own data. 

This project is very similar to the [KittiSeg](https://github.com/MarvinTeichmann/KittiSeg#kittiseg) and [KittiBox](https://github.com/MarvinTeichmann/KittiBox#kittibox) project. Both of these projects come with public training data. I can therefore recommend to use [KittiSeg](https://github.com/MarvinTeichmann/KittiSeg#kittiseg) as starting point, if you want to train on you own data.

The repository contains code for `training`, `evaluating` and `visualizing` classification problems in Tensorflow. It is build to be compatible with the [TensorVision](http://tensorvision.readthedocs.io/en/master/user/tutorial.html#workflow) backend which allows to organize experiments in a very clean way.

## Requirements

The code requires [Tensorflow 1.0](https://www.tensorflow.org/api_docs/) as well as the following python libraries: 

* matplotlib
* numpy
* Pillow
* scipy

Those modules can be installed using: `pip install numpy scipy pillow matplotlib` or `pip install -r requirements.txt`.


## Setup

1. Clone this repository: `https://github.com/MarvinTeichmann/KittiClass`
2. Initialize all submodules: `git submodule update --init --recursive`


## Tutorial

### Getting started

Run: `python demo.py --input_image data/demo/demo.png` to obtain a prediction using [demo.png](data//demo/demo.png) as input.

### Manage Data Storage

KittiSeg allows to separate data storage from code. This is very useful in many server environments. By default, the data is stored in the folder `KittiSeg/DATA` and the output of runs in `KittiSeg/RUNS`. This behaviour can be changed by setting the bash environment variables: `$TV_DIR_DATA` and `$TV_DIR_RUNS`.

Include  `export TV_DIR_DATA="/MY/LARGE/HDD/DATA"` in your `.profile` and the all data will be downloaded to `/MY/LARGE/HDD/DATA/data_road`. Include `export TV_DIR_RUNS="/MY/LARGE/HDD/RUNS"` in your `.profile` and all runs will be saved to `/MY/LARGE/HDD/RUNS/KittiSeg`

### Modifying Model & Train on your own data

The model is controlled by the file `hypes/KittiClass.json`. Modifying this file should be enough to train the model on your own data and adjust the architecture according to your needs. A description of the expected input format can be found [here](docu/inputs.md). I would advise to create a new hype file `hypes/my_hype.json` for your input data and start training by running: `python train.py --hypes hypes/my_hype.json`

#TODO provide examples

Once again, I would like to point you to [KittiSeg](https://github.com/MarvinTeichmann/KittiSeg#kittiseg) documentation, and should be used as a first start to understand the overall concept.

# Citation

If you benefit from this code, please cite our paper:

```
@article{teichmann2016multinet,
  title={MultiNet: Real-time Joint Semantic Reasoning for Autonomous Driving},
  author={Teichmann, Marvin and Weber, Michael and Zoellner, Marius and Cipolla, Roberto and Urtasun, Raquel},
  journal={arXiv preprint arXiv:1612.07695},
  year={2016}
}
```

